[script]
n0=;#############################################################################################################################
n1=;                    !ПРОСЬБА: НЕ ТРОГАЙТЕ НИЧЕГО НЕ ЗНАКОМОГО ВАМ РУКАМИ ИНАЧЕ ОНО СЛОМАЕТСЯ :)
n2=;#############################################################################################################################
n3=;
n4=;                                                              R E M O T E      S C R I P T S   7   (E V E N T S)
n5=;
n6=;                                #     #     #     #     #     #     #     #     #     #     #     #     #     #     #     #     #     # 
n7=;                                       #                                 NEORA TrioN EVENTS                                  #
n8=;                                              #                 Copyright 1999-2001 NEORA Group                    #
n9=;                                                      #           trion@neora.ru     www.NEORA.ru            #
n10=;                                                              #     #     #     #     #     #     #     #    #    #
n11=;
n12=ON 1:START:{
n13=  inc %TrionRunNum
n14=  if (%SMsgLog == on) {
n15=    write $shortfn($mircdir) $+ texts\NickServMsgLog.txt ------------------------- | write $shortfn($mircdir) $+ texts\NickServMsgLog.txt $date
n16=    write $shortfn($mircdir) $+ texts\ChanServMsgLog.txt ------------------------- | write $shortfn($mircdir) $+ texts\ChanServMsgLog.txt $date
n17=    write $shortfn($mircdir) $+ texts\MemoServMsgLog.txt ------------------------- | write $shortfn($mircdir) $+ texts\MemoServMsgLog.txt $date
n18=  }
n19=  unset %HideSNotice | .disable #* | startupactions
n20=}
n21=ON 1:CONNECT:{
n22=  if (%nickident == 1) && (%nickidentconn == 1) { 
n23=    if ( [ % $+ [ pass $+ [ $me ] ] ] != $null) { nickserv identify $me [ % $+ [ pass $+ [ $me ] ] ] }
n24=  }
n25=  if (%ChanForAutoJoin != $null) { join %ChanForAutoJoin }
n26=  if (%founderident == 1) { chanidentonconnect }
n27=  if (%ChList == on) { .timerlistchan_first 1 15 .list %ChListMask | .timerlistchan 0 $calc(%ChListRe * 60) .list %ChListMask }
n28=  if (%awayautomod == on) { .timerautoaway 0 5 autoawaycheck }
n29=  if (%soundthem == on) { if ($isalias(skn.snd.connect) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.connect } | set %soundthem off | .timer 1 10 set %soundthem on } 
n30=  if (%UPDmode == on) { if ($timer(UPD) == $null) { .timerUPD 1 60 NEORAnews } }
n31=  if (%DROPmntrNICK == on) || (%DROPmntrCHAN == on) {
n32=    if ($calc(%DrMrLASTcheckN + %DrMrNEXTcheckN) < $ctime) || ($calc(%DrMrLASTcheckC + %DrMrNEXTcheckC) < $ctime) { .timer 1 20 DROPmntr.start }
n33=  }
n34=}
n35=ON ^1:JOIN:#:{
n36=  if ($nick == $me) {
n37=    if (%colorenicks == on) { .timer 1 3 .coloreRE $chan }  
n38=    if (%autogreetmode == on) { msg $chan $greetcom(%autogreet,$chan,$nick) } 
n39=    if (%IALrenew == on) { .enable #updIALonJoin | set %updnick $+ $chan 0 | .timer 1 5 .updateIALonJoin $chan updnick $+ $chan } 
n40=    if (%infoonjoin == on) { chanInfoOnJoin $chan }
n41=    if (%founderident == 2) { chanidentonjoin $chan }
n42=    if (%topicautochange == on) { autotopicchange $chan }
n43=    if (%soundthem == on) { if ($isalias(skn.snd.join) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.join } }
n44=    if ($timer(AJBAN [ $+ [ $chan ] ] ) == 1) { .timerAJBAN [ $+ [ $chan ] ] off }
n45=    if ($timer(AJinvite [ $+ [ $chan ] ] ) == 1) { .timerAJinvite [ $+ [ $chan ] ] off }
n46=    if ($timer(AJlimit [ $+ [ $chan ] ] ) == 1) { .timerAJlimit [ $+ [ $chan ] ] off }
n47=    if ($timer(AJkey [ $+ [ $chan ] ] ) == 1) { .timerAJkey [ $+ [ $chan ] ] off }
n48=
n49=    if ($isalias(skn.join.me) == $true) { echo $chan $skn.join.me | halt }
n50=  }
n51=  if ($nick != $me) { 
n52=    if (%colorenicks == on) { coloreRE $chan }
n53=    if (%autogreetcommode == on) && ($chan == $read -w $+ $chan $mircdirtexts\mychan.txt) { 
n54=      if (%greetFlProt != on) { .timer 1 1 msg $chan $greetcom(%autogreetcom,$chan,$nick) | set -u5 %greetFlProt on }
n55=    }
n56=    if ($isalias(skn.join) == $true) { echo $chan $skn.join | halt }
n57=
n58=  }
n59=}
n60=ON ^1:OP:#:{
n61=  if (%colorenicks == on) { coloreRE $chan }
n62=  if ($opnick != $me) {
n63=    if ($isalias(skn.op) == $true) { echo $chan $skn.op | halt }
n64=  }
n65=  if ($opnick == $me) {
n66=    if (%MFlProt == on) {
n67=      if (%MFlWarning == on) { 
n68=        if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n69=        halt 
n70=      }
n71=      if (%MFlQuont == $null) { set -u [ $+ [ %MFlPeriod ] ] %MFlQuont 0 }
n72=      if (%MFlQuont >= 0) { 
n73=        inc %MFlQuont 1 
n74=        if (%MFlQuont >= %MFlLim) { 
n75=          if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n76=          if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n77=          set -u [ $+ [ $calc(%MFlignor * 60) ] ] %MFlWarning on 
n78=          halt
n79=        }
n80=      }
n81=    }
n82=    if (%soundthem == on) { if ($isalias(skn.snd.op) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.op } }
n83=    if ($isalias(skn.op.me) == $true) { echo $chan $skn.op.me | halt }
n84=  }
n85=}
n86=ON ^1:DEOP:#:{
n87=  if ($opnick == $me) {
n88=    if ($nick != chanserv) && ($nick != $me) {
n89=      if (1 isin %DPScript) { chanserv op $chan $me }
n90=      if (2 isin %DPScript) { chanserv deop $chan $nick }
n91=      .timer 1 3 DeOpSelfProtect $chan $nick
n92=    }
n93=    if (%MFlProt == on) {
n94=      if (%MFlWarning == on) { 
n95=        if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n96=        halt 
n97=      }
n98=      if (%MFlQuont == $null) { set -u [ $+ [ %MFlPeriod ] ] %MFlQuont 0 }
n99=      if (%MFlQuont >= 0) { 
n100=        inc %MFlQuont 1 
n101=        if (%MFlQuont >= %MFlLim) { 
n102=          if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n103=          if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n104=          set -u [ $+ [ $calc(%MFlignor * 60) ] ] %MFlWarning on 
n105=          halt
n106=        }
n107=      }
n108=    }
n109=    if (%colorenicks == on) { coloreRE $chan }
n110=    if (%soundthem == on) { if ($isalias(skn.snd.deop) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.deop } }
n111=    if ($isalias(skn.deop.me) == $true) { echo $chan $skn.deop.me | halt }
n112=  }
n113=  if ($opnick != $me) {
n114=    if (%colorenicks == on) { coloreRE $chan }
n115=    if ($isalias(skn.deop) == $true) { echo $chan $skn.deop | halt }
n116=  }
n117=}
n118=on ^1:VOICE:#: { 
n119=  if (%colorenicks == on) { coloreRE $chan }
n120=  if ($vnick != $me) {
n121=    if ($isalias(skn.voice) == $true) { echo $chan $skn.voice | halt }
n122=  }
n123=  if ($vnick == $me) {
n124=
n125=    if (%MFlProt == on) {
n126=      if (%MFlWarning == on) { 
n127=        if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n128=        halt 
n129=      }
n130=      if (%MFlQuont == $null) { set -u [ $+ [ %MFlPeriod ] ] %MFlQuont 0 }
n131=      if (%MFlQuont >= 0) { 
n132=        inc %MFlQuont 1 
n133=        if (%MFlQuont >= %MFlLim) { 
n134=          if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n135=          if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n136=
n137=          set -u [ $+ [ $calc(%MFlignor * 60) ] ] %MFlWarning on 
n138=          halt
n139=        }
n140=      }
n141=    }
n142=    if (%soundthem == on) { if ($isalias(skn.snd.voice) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.voice } }
n143=    if ($isalias(skn.voice.me) == $true) { echo $chan $skn.voice.me | halt }
n144=  }
n145=}
n146=on ^1:DEVOICE:#:{
n147=  if (%colorenicks == on) { coloreRE $chan }
n148=  if ($vnick != $me) {
n149=    if ($isalias(skn.devoice) == $true) { echo $chan $skn.devoice | halt }
n150=  }
n151=  if ($vnick == $me) {
n152=    if (%MFlProt == on) {
n153=      if (%MFlWarning == on) { 
n154=        if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n155=        halt 
n156=      }
n157=      if (%MFlQuont == $null) { set -u [ $+ [ %MFlPeriod ] ] %MFlQuont 0 }
n158=      if (%MFlQuont >= 0) { 
n159=        inc %MFlQuont 1 
n160=        if (%MFlQuont >= %MFlLim) { 
n161=          if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n162=          if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n163=          set -u [ $+ [ $calc(%MFlignor * 60) ] ] %MFlWarning on 
n164=          halt
n165=        }
n166=      }
n167=    }
n168=    if (%soundthem == on) { if ($isalias(skn.snd.devo) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.devo } }
n169=    if ($isalias(skn.devoice.me) == $true) { echo $chan $skn.devoice.me | halt }
n170=  }
n171=}
n172=on ^1:KICK:*:{
n173=  if ($knick == $me) {
n174=    if ($nick == $me) { goto next }
n175=    if (%KPScript != $null) { 
n176=      if (1 isin %KPScript) { .raw join $chan }
n177=      .timer 1 3 KickSelfProtect $chan $nick 
n178=    }
n179=    :next
n180=    if (%soundthem == on) { if ($isalias(skn.snd.mekicked) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.mekicked } }
n181=    if ($isalias(skn.kick.me) == $true) { echo -a $skn.kick.me($1-) | halt }
n182=  }
n183=  if ($knick != $me) {
n184=    if ($nick == $me) {
n185=      if (%soundthem == on) { if ($isalias(skn.snd.Ikick) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.Ikick } }
n186=    }
n187=    if ($isalias(skn.kick) == $true) { echo $chan $skn.kick($1-) | halt }
n188=  }
n189=}
n190=on ^1:BAN:#:{
n191=  var %bind = -1
n192=  :round
n193=  inc %bind
n194=  if (%bind >= 10) { goto next }
n195=  if ($banmask isin $address($me,%bind)) { 
n196=    if (1 isin %BPScript) && ($nick != $me) { mode $chan -b $banmask }
n197=    if (%MFlProt == on) {
n198=      if (%MFlWarning == on) { 
n199=        if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n200=        halt 
n201=      }
n202=      if (%MFlQuont == $null) { set -u [ $+ [ %MFlPeriod ] ] %MFlQuont 0 }
n203=      if (%MFlQuont >= 0) { 
n204=        inc %MFlQuont 1 
n205=        if (%MFlQuont >= %MFlLim) { 
n206=          if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n207=          if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n208=          set -u [ $+ [ $calc(%MFlignor * 60) ] ] %MFlWarning on 
n209=          halt
n210=        }
n211=      }
n212=    }
n213=    if (%BPScript != $null) && ($nick != $me) { BanSelfProtect $chan $nick $banmask }
n214=    if (%soundthem == on) { if ($isalias(skn.snd.ban) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.ban } }
n215=    if ($isalias(skn.ban.me) == $true) { echo $chan $skn.ban.me | halt }
n216=  }
n217=  else { goto round }
n218=  :next
n219=  if ($isalias(skn.ban) == $true) { echo $chan $skn.ban | halt }
n220=}
n221=on ^1:UNBAN:#:{
n222=  var %banind = -1
n223=  :round
n224=  inc %banind
n225=  if (%banind >= 10) { goto next }
n226=  if ($banmask isin $address($me,%banind)) { 
n227=    if (%MFlProt == on) {
n228=      if (%MFlWarning == on) { 
n229=        if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n230=        halt 
n231=      }
n232=      if (%MFlQuont == $null) { set -u [ $+ [ %MFlPeriod ] ] %MFlQuont 0 }
n233=      if (%MFlQuont >= 0) { 
n234=        inc %MFlQuont 1 
n235=        if (%MFlQuont >= %MFlLim) { 
n236=          if ($dialog(modeflood) != modeflood) { dialog -mn modeflood modeflood }
n237=          if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n238=          set -u [ $+ [ $calc(%MFlignor * 60) ] ] %MFlWarning on 
n239=          halt
n240=        }
n241=      }
n242=    }
n243=    if (%soundthem == on) { if ($isalias(skn.snd.unban) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.unban } }
n244=    if ($isalias(skn.unban.me) == $true) { echo $chan $skn.unban.me | halt }
n245=  }
n246=  else { goto round }
n247=  :next
n248=  if ($isalias(skn.unban) == $true) { echo $chan $skn.unban | halt }
n249=}
n250=on ^1:NICK:{
n251=  if (%lognickchange == on) { write $shortfn($mircdir) $+ texts\nickchange.txt $date $time - $nick => $newnick }
n252=  if ($nick == $me) {
n253=    if (%nickident == 1) && (%nickidentnick == 1) { 
n254=      if ($newnick == $read -w $+ $newnick $mircdirtexts\mynick.txt) {
n255=        if ( [ % $+ [ pass $+ [ $newnick ] ] ]  != $null) { nickserv identify [ % $+ [ pass $+ [ $newnick ] ] ] }
n256=      }
n257=    }
n258=  }
n259=  if ($nick != $me) {
n260=    /var %nchanquant = $comchan($newnick,0) + 1
n261=    :next | dec %nchanquant 1
n262=    if (%nchanquant <= 0) { halt }
n263=    if ($isalias(skn.nick) == $true) { echo $comchan($newnick,%nchanquant) $skn.nick | goto next }
n264=    return
n265=  }
n266=}
n267=on ^1:PART:#: {
n268=  if ($isalias(skn.part) == $true) { 
n269=    if ($1 != $null) { echo $chan $skn.part($1-) | halt }
n270=    if ($1 == $null) { echo $chan $skn.part | halt }
n271=  }
n272=}
n273=on ^1:QUIT:{
n274=  if ($nick != $me) {
n275=    if (%qmsgcollect == on) {
n276=      var %currquit = QUIT MSG: $strip($1-)
n277=      if (%currquit != $read -w" $+ %currquit $+ " $mircdirtexts\QmsgesCollect.txt) {
n278=        write $shortfn($mircdir) $+ texts\QmsgesCollect.txt $nick ( $+ $date - $time $+ )
n279=        write $shortfn($mircdir) $+ texts\QmsgesCollect.txt QUIT MSG: $strip($1-)
n280=        write $shortfn($mircdir) $+ texts\QmsgesCollect.txt =================
n281=      }
n282=    }
n283=    /var %qchanquant = $comchan($nick,0) + 1
n284=    :next | dec %qchanquant 1
n285=    if (%qchanquant <= 0) { halt }
n286=    if ($isalias(skn.quit) == $true) { echo $comchan($nick,%qchanquant) $skn.quit($1-) | goto next }
n287=    return
n288=  }
n289=}
n290=on ^1:TOPIC:#:{
n291=  if (%topiccollect == on) { 
n292=    var %currtop = TOPIC: $strip($1-) 
n293=    if (%currtop != $read -w" $+ %currtop $+ " $mircdirtexts\topics.txt) { 
n294=      write $shortfn($mircdir) $+ texts\topics.txt -> $chan - $nick ( $+ $date - $time $+ ) $+ : 
n295=      write $shortfn($mircdir) $+ texts\topics.txt TOPIC: $strip($1-) 
n296=      write $shortfn($mircdir) $+ texts\topics.txt =================
n297=    } 
n298=  }
n299=  if ($isalias(skn.topic) == $true) { echo $chan $skn.topic($1-) | halt }
n300=}
n301=raw 332:*:{ if ($isalias(skn.see.topic) == $true) { echo $2 $skn.see.topic($3-) | halt } }
n302=raw 333:*:{ if ($isalias(skn.who.topic) == $true) { echo $2 $skn.who.topic($3,$4) | halt } }
n303=on 1:DISCONNECT:{
n304=  if ($dialog(awaywarn) == awaywarn) { dialog -k awaywarn awaywarn }
n305=  if ($me == %nocurrentnick) { nick %currentnick | unset %since | unset %currentnick | unset %nocurrentnick }
n306=  if (%awayautomod == on) { timerautoaway off } | if (%topicautochange == on) { .timerATopic* off }
n307=  unset %CflPrWAR | unset %CflMethStop
n308=  .disable #*
n309=  if (%soundthem == on) { if ($isalias(skn.snd.disconnect) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.disconnect } }
n310=}
n311=on ^1:INVITE:#: {
n312=  if (%InvFlProt == on) {
n313=    if (%InvFlWarning == on) { 
n314=      if ($dialog(inviteflood) != inviteflood) { dialog -mn inviteflood inviteflood }
n315=      halt 
n316=    }
n317=    if (%InvFlQuont == $null) { set -u [ $+ [ %InvFlPeriod ] ] %InvFlQuont 0 }
n318=    if (%InvFlQuont >= 0) { 
n319=      inc %InvFlQuont 1 
n320=      if (%InvFlQuont >= %InvFlLim) { 
n321=        if ($dialog(inviteflood) != inviteflood) { dialog -mn inviteflood inviteflood }
n322=        if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n323=        set -u [ $+ [ $calc(%InvFlignor * 60) ] ] %InvFlWarning on 
n324=        halt
n325=      }
n326=    }
n327=  }
n328=  if (%soundthem == on) { if ($isalias(skn.snd.invite) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.invite } }
n329=  if ($isalias(skn.invite) == $true) { echo -a $skn.invite | halt }
n330=}
n331=on ^1:MODE:#:{
n332=  if (%soundthem == on) { if ($isalias(skn.snd.mode) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.mode } }
n333=  if ($isalias(skn.mode) == $true) { echo $chan $skn.mode($1-) | halt }
n334=}
n335=on ^1:OPEN:?: {
n336=  if (%OpenFlProt == on) {
n337=    if (%OpenFlWarning == on) { 
n338=      if ($dialog(openflood) != openflood) { dialog -mn openflood openflood }
n339=      halt 
n340=    }
n341=    if (%OpenFlQuont == $null) { set -u [ $+ [ %OpenFlPeriod ] ] %OpenFlQuont 0 }
n342=    if (%OpenFlQuont > 0) { 
n343=      inc %OpenFlQuont 1 
n344=      if (%OpenFlQuont >= %OpenFlLim) { 
n345=        if ($dialog(openflood) != openflood) { dialog -mn openflood openflood }
n346=        if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n347=        set -u [ $+ [ $calc(%OpenFlignor * 60) ] ] %OpenFlWarning on 
n348=        halt
n349=      }
n350=    }
n351=  }
n352=  if (%soundthem == on) { if ($isalias(skn.snd.private) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.private } }
n353=  if ($away == $true) { msg $nick 10¦14AwAY10¦>14goNe10>¦14 $+ $duration($calc($ctime - %since)) $+ 10¦14ago }
n354=  if ($isalias(skn.open) == $true) { echo -a $skn.open }
n355=}
n356=on ^*:NOTICE:*:*:{
n357=  if ($nick == nickserv) || ($nick == chanserv) || ($nick == memoserv) {
n358=    if ($nick == memoserv) { 
n359=      if (Memo has been sent to user isin $1-) { dialog -mn MemoSentUser MemoSentUser }
n360=      if (Memo isin $1- && has been marked as deleted isin $1-) { dialog -mn MemoMarkDel MemoMarkDel }
n361=      if (Memo isin $1- && has been marked as undeleted isin $1-) { dialog -mn MemoMarkUnDel MemoMarkUnDel }
n362=      if (Purged isin $1- && memos from your account isin $1-) { MemoDelQuont $2 }
n363=      if (All memos have been deleted and purged isin $1-) { dialog -mn MemoAllDel MemoAllDel }
n364=      if (%SMsgLog == on) { write $shortfn($mircdir) $+ texts\MemoServMsgLog.txt $timestamp $1- }
n365=      if (New memo from isin $1-) { 
n366=        set %newmemoNick от $4 | dialog -mn newmemo newmemo | did -i newmemo 10 1 Новое MEMO-сообщение 
n367=        did -i newmemo 11 1 %newmemoNick 
n368=        if (%soundthem == on) { if ($isalias(skn.snd.newmemo) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.newmemo } }
n369=        halt 
n370=      }
n371=      if (You have isin $1- && new memo isin $4-) && ($dialog(newmemo) != newmemo) { 
n372=        set %newmemoCuont $3 | dialog -mn newmemo newmemo 
n373=        did -i newmemo 10 1 %newmemoCuont новое MEMO-сообщение 
n374=        if (%soundthem == on) { if ($isalias(skn.snd.newmemo) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.newmemo } }
n375=        halt 
n376=      }
n377=    }
n378=    if ($nick == chanserv) {
n379=      if (has deopped $me isin $1-) { if (1 isin %DPScript) { chanserv op $chan $me } | if (2 isin %DPScript) { chanserv deop $chan $1 } | .timer 1 3 DeOpSelfProtect $chan $1 }
n380=      if (%SMsgLog == on) { write $shortfn($mircdir) $+ texts\ChanServMsgLog.txt $timestamp $1- }
n381=      if (%ChSUnBanJ == on) && (Any bans against you on isin $1-) { join $6 }
n382=      if (%ChSInviteJ == on) && (ChanServ (service@dal.net) invites you to isin $1-) { join $7 }
n383=      if (does not wish to be added to channel operator lists isin $2-) { NOOPdetected $1 }
n384=      if (You must identify as the founder to change isin $1- && settings. isin $1-) { dialog -mn ChanServIdentErr ChanServIdentErr }
n385=      if (has been successfully added to the isin $1- && list of isin $1-) { ChanListADDone $1 $8 }
n386=      if (has been successfully removed from the isin $1- && list of isin $1-) { ChanListREMone $1 $8 }
n387=      if (already exists on the isin $1- && list of isin $1-) { ChanListADDErr $1 $6 }
n388=      if (Access for isin $1- && changed from isin $1-) { ChanListAccChange $strip($3) $8 $10 }
n389=      if (You do not have access to op people on isin $1-) { dialog -mn NotHaveAccess NotHaveAccess }
n390=      if ($dialog(chanservcenter) == chanservcenter) {
n391=        if (The channel isin $1-2 && is already registered isin $4-) { chanPreRem $strip($3) | dialog -mn AlreadyReg AlreadyReg | write $shortfn($mircdir) $+ texts\chanserv.txt ....ОШИБКА! Канал $strip($3) уже зарегистрирован | write $shortfn($mircdir) $+ texts\chanserv.txt ================== }
n392=        if (You must be opped isin $1- && to register it isin $1-) { chanPreRem $strip($6) | dialog -mn MustBeInside MustBeInside | write $shortfn($mircdir) $+ texts\chanserv.txt ....ОШИБКА! Вы должны находиться на регистрируемом канале | write $shortfn($mircdir) $+ texts\chanserv.txt ===================== }
n393=        if (The channel isin $1-2 && has been registered to you isin $4-) { dialog -mn ChanWereReg ChanWereReg | write $shortfn($mircdir) $+ texts\chanserv.txt ....КАНАЛ УСПЕШНО ЗАРЕГИСТРИРОВАН. | write $shortfn($mircdir) $+ texts\chanserv.txt ===================== }
n394=        if (Channel management of isin $1-) { ChanDropDone $strip($4) }
n395=        if (The channel isin $1- && is not registered. isin $1-) { dialog -mn ChanIsNotReg ChanIsNotReg | did -r chanservcenter 53 }
n396=        if (Founder for isin $1-2 && changed to isin $4-5) { ChanFounderChange $3 $6 }
n397=        if (Password for isin $1- && has been set to isin $1-) { ChanPassChangeDone $3 $8 }
n398=        if (The current (old) password you have supplied is incorrect. isin $1-) { dialog -mn ChanPassChangeIncorr ChanPassChangeIncorr | write $shortfn($mircdir) $+ texts\chanserv.txt ОШИБКА: НЕВЕРНЫЙ ПАРОЛЬ | write $shortfn($mircdir) $+ texts\chanserv.txt =================== }
n399=        if (URL for isin $1- && has been set to isin $1-) { dialog -mn URLhasBeenSet URLhasBeenSet | did -i URLhasBeenSet 12 1 $strip($8) | did -r chanservcenter 233 }
n400=        if (URL for isin $1-2 && has been reset. isin $1-) { dialog -mn URLhasBeenReset URLhasBeenReset }
n401=        if (Description for isin $1- && is set to isin $1-) { dialog -mn ChanDescrSetTo ChanDescrSetTo | did -i ChanDescrSetTo 12 1 $7- }
n402=        if (Description for isin $1- && has been set to isin $1-) { dialog -mn ChanDescrHBset ChanDescrHBset | did -i ChanDescrHBset 12 1 $8- }
n403=      }
n404=    }
n405=    if ($nick == nickserv) {
n406=      if (%SMsgLog == on) { write $shortfn($mircdir) $+ texts\NickServMsgLog.txt $timestamp $1- }
n407=      if (yourself isn't very shagadelic... I can't do it isin $1-) { dialog -mn GhostYourSelf GhostYourSelf }
n408=      if (You must identify before modifying your nick options isin $1-) { dialog -m NickNotIdent NickNotIdent }
n409=      if ($dialog(nickservcenter) == nickservcenter) {
n410=        if (Registration for this nick is not complete. Please check isin $1-) { dialog -mn RegNickNotCompl RegNickNotCompl }
n411=        if (has been temporarily registered to you isin $1-) { dialog -mn TempNickReg TempNickReg | TempNReg }
n412=        if (has been successfully dropped isin $1-) { NickSuccessDroped $strip($3) }
n413=        if (You must identify prior to dropping your nick isin $1-) { dialog -mn DropErrorIdent DropErrorIdent | did -b nickservcenter 50,52,53 | did -r nickservcenter 49,52 | dialog -c DropNickReqest }
n414=        if (Your email address has been set to isin $1-) { dialog -mn EmailChangeCompl EmailChangeCompl }
n415=        if (Your password has been reset. Please write it down isin $1-) { dialog -mn PassChangeCompl PassChangeCompl | PassChangePro }
n416=        if (The current (old) password you have supplied is incorrect isin $1-) { dialog -mn IncorrPassChange IncorrPassChange | IncorrPassChange }
n417=        if (Your URL has been set to isin $1-) { URLforNick $7 }
n418=        if (Your URL has been deleted isin $1-) { URLforNick }
n419=        if (You currently do not have a URL set isin $1-) { URLforNick 0 }
n420=        if (The mask isin $1- && has been added successfully isin $1-) { MaskBeenSet $3 }
n421=        if (The mask isin $1- && has been removed isin $1-) { MaskBeenRem $3 }
n422=        if (The mask isin $1- && was not found in your access list isin $1-) { MaskNotFound $3 }
n423=        if (The access list for isin $1- && has been wiped isin $1-) { dialog -mn MaskListCleard MaskListCleard }
n424=      }
n425=    }
n426=    if (%SMWinMode == 0) { goto free }
n427=    if (%SMWinMode == 1) {
n428=      if ($1 == [VERBOSE]) { echo -a VERBOSE: $2- }
n429=      if ($window(@services) == $null) { 
n430=        window -mek0 @Services $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46)
n431=      }
n432=      if (%SMsgColMode == All) { 
n433=        if ($nick == nickserv) { echo $calc(%SMsgColAll - 1) @Services $timestamp Nickserv> $1- } 
n434=        if ($nick == chanserv) { echo $calc(%SMsgColAll - 1) @Services $timestamp Chanserv> $1- } 
n435=        if ($nick == operserv) { echo $calc(%SMsgColAll - 1) @Services $timestamp Operserv> $1- } 
n436=        if ($nick == memoserv) { echo $calc(%SMsgColAll - 1) @Services $timestamp Memoserv> $1- } 
n437=      }
n438=      if (%SMsgColMode == Each) {
n439=        if ($nick == nickserv) { echo $calc(%SMsgColEachN - 1) @Services $timestamp Nickserv> $1- } 
n440=        if ($nick == chanserv) { echo $calc(%SMsgColEachC - 1) @Services $timestamp Chanserv> $1- } 
n441=        if ($nick == operserv) { echo $calc(%SMsgColEachO - 1) @Services $timestamp Operserv> $1- } 
n442=        if ($nick == memoserv) { echo $calc(%SMsgColEachM - 1) @Services $timestamp Memoserv> $1- } 
n443=      }
n444=    }
n445=    if (%SMWinMode == 2) {
n446=      if ($1 == [VERBOSE]) { echo -a VERBOSE: $2- }
n447=      if (%SMsgColMode == Each) {
n448=        if ($nick == nickserv) { 
n449=          if ($window(@nickserv) == $null) { window -mek0 @NickServ $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46) } 
n450=          echo $calc(%SMsgColEachN - 1) @NickServ $timestamp $+ > $1- 
n451=        }
n452=        if ($nick == chanserv) { 
n453=          if ($window(@chanserv) == $null) { window -mek0 @ChanServ $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46) } 
n454=          echo $calc(%SMsgColEachC - 1) @ChanServ $timestamp $+ > $1- 
n455=        }
n456=        if ($nick == operserv) { 
n457=          if ($window(@operserv) == $null) { window -mek0 @OperServ $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46) } 
n458=          echo $calc(%SMsgColEachO - 1) @OperServ $timestamp $+ > $1- 
n459=        }
n460=        if ($nick == memoserv) { 
n461=          if ($window(@memoserv) == $null) { window -mek0 @MemoServ $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46) } 
n462=          echo $calc(%SMsgColEachM - 1) @MemoServ $timestamp $+ > $1- 
n463=        }
n464=      }
n465=      if (%SMsgColMode == All) {
n466=        if ($nick == nickserv) { 
n467=          if ($window(@nickserv) == $null) { window -mek0 @NickServ $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46) } 
n468=          echo $calc(%SMsgColAll - 1) @NickServ $timestamp $+ > $1- 
n469=        }
n470=        if ($nick == chanserv) {
n471=          if ($window(@chanserv) == $null) { window -mek0 @ChanServ $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46) } 
n472=          echo $calc(%SMsgColAll - 1) @ChanServ $timestamp $+ > $1- 
n473=        }
n474=        if ($nick == memoserv) { 
n475=          if ($window(@memoserv) == $null) { window -mek0 @MemoServ $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46) } 
n476=          echo $calc(%SMsgColAll - 1) @MemoServ $timestamp $+ > $1- 
n477=        }
n478=      }
n479=    }
n480=    halt
n481=  }
n482=  if ($nick == k9) && ($network == ChatNet) {
n483=    if ($window(@k9) == $null) { window -mek0 @k9 $gettok($readini $mircdirmirc.ini fonts fchannel,1,46) $gettok($readini $mircdirmirc.ini fonts fchannel,2-,46) }
n484=    echo $colour(notice) @k9 $timestamp $+ > $1-
n485=    halt
n486=  }
n487=  else {
n488=    if (%TflProtect == on) {
n489=      if (%TflPrWar == ON) { 
n490=        if ($nick == %TflPrNick) { 
n491=          if (%TflPrWarnB == on) { ban -u $+ $calc(%TflPrSinglB * 60) %TflPrChan %TflPrNick 3 }
n492=          if (%TflPrWarnK == on) { kick %TflPrChan %TflPrNick %FlKreasNote }
n493=          unset %TflPrWar
n494=          halt
n495=        } 
n496=      }
n497=      if (%TflPr. [ $+ [ $nick ] ] > 0) {
n498=        inc %TflPr. [ $+ [ $nick ] ] 1
n499=        if (%TflPr. [ $+ [ $nick ] ] >= %TflPrTimes) {
n500=          if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n501=          if (%TflPrMode == auto) { 
n502=            set %TflPrNick $nick | set %TflPrChan $chan
n503=            if (%TflPrDialog == show) { if ($dialog(TflPrSwitch) != TflPrSwitch) dialog -mn TflPrSwitch TflPrSwitch }
n504=            if (%TflPrWarn == on) {
n505=              if (%SelfFlPr != on) { msg %TflPrChan 4! $+ %TflPrNick $+ 4-> %TflPrWarnMsg | set -u5 %SelfFlPr on }
n506=              set -u [ $+ [ $calc(%TflPrIgnore * 60) ] ] %TflPrWar ON 
n507=            }
n508=            if (%TflPrWarn == off) { 
n509=              if (%TflPrBan == on) { ban -u $+ $calc(%TflPrSinglB * 60) %TflPrChan %TflPrNick 3 } 
n510=              kick %TflPrChan %TflPrNick %FlKreasNote
n511=            }
n512=          }
n513=          if (%TflPrMode == manu) { 
n514=            if ($dialog(TflDetect) != TflDetect) { 
n515=              dialog -mn TflDetect TflDetect | dialog -t TflDetect TEXT Flood от $nick на канале $chan
n516=              did -i TflDetect 16 1 Игнорировать $nick в течении: | set %TflPrNick $nick | set %TflPrChan $chan
n517=            } 
n518=            if ($dialog(TflDetect) == TflDetect) { }
n519=          }
n520=          unset %TflPr. [ $+ [ $nick ] ]
n521=        }
n522=      }
n523=      else { set -u [ $+ [ %TflPrPeriod ] ] %TflPr. [ $+ [ $nick ] ] 1 }
n524=    }
n525=  }
n526=  :free
n527=}
n528=on *:INPUT:*:{
n529=  if ($chr(47) isin $1) { goto free }
n530=  if (%styliZator == off) && (%nickinsert == off) { goto end }
n531=  if (%styliZator == off) && (%nickinsert == on) { goto onlynick }
n532=  if (%styliZator == on) && (%nickinsert == off) { goto styles }
n533=  if (%styliZator == on) && (%nickinsert == on) { goto styles }
n534=  :onlynick
n535=  if ($snick(#,1) != $null) {
n536=    if (%nickincmode == auto) {
n537=      if (%nickincvar == 1) { say $snick(#,1) -> $1- | halt }
n538=      if (%nickincvar == 2) { say 9-< $snick(#,1) 9>- $1- | halt }
n539=      if (%nickincvar == 3) { say $chr(171) $+ $snick(#,1) $+ $chr(187) $1- | halt }
n540=      if (%nickincvar == 4) { say <> $+ $snick(#,1) $+ <> $1- | halt }
n541=      if (%nickincvar == 5) { say $nickedit $1- | halt }
n542=    }
n543=    else { goto end }
n544=  }
n545=  else { goto end }
n546=  :styles
n547=  if (%SelfStyle == on) { neostyle [ $+ [ 2 [ $+ [ %SelfStyleVar ] ] ] ] $chan $1- | halt }
n548=  else { neostyle [ $+ [ %styleNumb ] ] $chan $1- | halt }
n549=  :free
n550=  if ($left($1,5) == /away) && ($len($1-) == 5) { 
n551=    if ($dialog(awaywarn) == awaywarn) { dialog -c awaywarn }
n552=  }
n553=  if ($left($1,5) == /away) && ($len($1-) > 5) { goneaway $2- }
n554=  :end
n555=}
n556=on ^1:NOTIFY:{
n557=  if (%soundthem == on) { if ($isalias(skn.snd.notify) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.notify } }
n558=  if ($isalias(skn.notify) == $true) { echo -a $skn.notify | halt }
n559=}
n560=on ^1:UNOTIFY:{
n561=  if (%soundthem == on) { if ($isalias(skn.snd.Unotify) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.Unotify } }
n562=  if ($isalias(skn.unotify) == $true) { echo -a $skn.unotify | halt }
n563=}
n564=on ^1:SNOTICE:*:{
n565=  if (%HideSNotice == on) { halt }
n566=  if (%sNoticeHide == on) {
n567=    if (Looking up your hostname isin $1-) { set -u120 %HideSNotice on | halt }
n568=  }
n569=}
n570=on ^*:ACTION:*:#:{
n571=  if (%TflProtect == on) {
n572=    if (%TflPrWar == ON) { 
n573=      if ($nick == %TflPrNick) { 
n574=        if (%TflPrWarnB == on) { ban -u $+ $calc(%TflPrSinglB * 60) %TflPrChan %TflPrNick 3 }
n575=        if (%TflPrWarnK == on) { kick %TflPrChan %TflPrNick %FlKreasAct  }
n576=        unset %TflPrWar
n577=        halt
n578=      } 
n579=    }
n580=    if (%TflPr. [ $+ [ $nick ] ] > 0) {
n581=      inc %TflPr. [ $+ [ $nick ] ] 1
n582=      if (%TflPr. [ $+ [ $nick ] ] >= %TflPrTimes) {
n583=        if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n584=        if (%TflPrMode == auto) { 
n585=          set %TflPrNick $nick | set %TflPrChan $chan
n586=          if (%TflPrDialog == show) { if ($dialog(TflPrSwitch) != TflPrSwitch) dialog -mn TflPrSwitch TflPrSwitch }
n587=          if (%TflPrWarn == on) { 
n588=            if (%SelfFlPr != on) { msg %TflPrChan 4! $+ %TflPrNick $+ 4-> %TflPrWarnMsg | set -u5 %SelfFlPr on }
n589=            set -u [ $+ [ $calc(%TflPrIgnore * 60) ] ] %TflPrWar ON 
n590=          }
n591=          if (%TflPrWarn == off) { 
n592=            if (%TflPrBan == on) { ban -u $+ $calc(%TflPrSinglB * 60) %TflPrChan %TflPrNick 3 } 
n593=            kick %TflPrChan %TflPrNick %FlKreasAct 
n594=          }
n595=        }
n596=        if (%TflPrMode == manu) { 
n597=          if ($dialog(TflDetect) != TflDetect) { 
n598=            dialog -mn TflDetect TflDetect | dialog -t TflDetect TEXT Flood от $nick на канале $chan
n599=            did -i TflDetect 16 1 Игнорировать $nick в течении: | set %TflPrNick $nick | set %TflPrChan $chan
n600=          } 
n601=          if ($dialog(TflDetect) == TflDetect) { }
n602=        }
n603=        unset %TflPr. [ $+ [ $nick ] ]
n604=      }
n605=    }
n606=    else { set -u [ $+ [ %TflPrPeriod ] ] %TflPr. [ $+ [ $nick ] ] 1 }
n607=  }
n608=  if (%SwearMode == on) && ($me isop $chan) { 
n609=    var %SCInd = 0
n610=    :nextW
n611=    inc %SCInd 1
n612=    if (%SCInd > $lines($mircdirtexts\Swear.txt)) { goto more }
n613=    if ($read -l $+ %SCInd $mircdirtexts\Swear.txt isin $1-) { SwearAction $chan $nick | goto more }
n614=    goto nextW
n615=  }
n616=  :more
n617=  if (%colmsg == on) && ($nick == $snick(#,1)) { 
n618=    if (%colmsgtype == 1) { echo $colour(normal) $chan $timestamp 10< $+ $nick $+ > $1-  | halt }
n619=    if (%colmsgtype == 2) { echo $colour(normal) $chan $timestamp < $+ $nick $+ > $1-  | halt }
n620=    if (%colmsgtype == 3) { echo $colour(normal) $chan $timestamp < $+ $nick $+ > $1- | splay $shortfn($mircdirsounds) $+ \blip.wav | halt }
n621=  }
n622=}
n623=CTCP *:*:{
n624=  if (%CflMethStop == ON) { if (%notenick == $nick) { CflKBalies1 $nick } | halt }
n625=  if ($comchan($nick,0) == 0) { 
n626=    if ($nick !isin %CflNick) { set %CflNick %CflNick $+ , $+ $nick }
n627=    if ($dialog(outCRekv) == outCRekv) { 
n628=      if ($1 == version) { %CflContOutV = %CflContOutV + 1 | did -i outCRekv 22 1 %CflContOutV }
n629=      elseif ($1 == ping) { %CflContOutP = %CflContOutP + 1 | did -i outCRekv 24 1 %CflContOutP }
n630=      elseif ($1 == time) { %CflContOutT = %CflContOutT + 1 | did -i outCRekv 26 1 %CflContOutV }
n631=      else { %CflContOutO = %CflContOutO + 1 | did -i outCRekv 28 1 %CflContOutO ( $+ $1 $+ ) }
n632=      dialog -t outCRekv External Ctcp Request from $nick : $1 | did -r outCRekv 13 1 | ctcpVARlist $1 
n633=      did -i outCRekv 16 1 Игнорировать $nick 3 минуты
n634=      %CflContOut = %CflContOut + 1
n635=      .timerOutCrekv1 -m 0 400 did -i outCRekv 19 1 CTCP-запросы продолжают поступать (Запросов: $+ %CflContOut $+ )
n636=      .timerOutCrekv2 -m 0 800 did -r outCRekv 19
n637=      dialog -s outCRekv 90 90 520 200
n638=      set %Cask $1 | set %Cnick $nick
n639=    }
n640=    if ($dialog(outCRekv) != outCRekv) { 
n641=      dialog -mn outCRekv outCRekv 
n642=      dialog -t outCRekv External Ctcp Request from $nick : $1 | ctcpVARlist $1 
n643=      did -i outCRekv 16 1 Игнорировать $nick 3 минуты
n644=      set %CflContOut 0 | set %CflContOutV 0 | set %CflContOutP 0 | set %CflContOutT 0 | set %CflContOutO 0
n645=      set %Cask $1 | set %Cnick $nick
n646=    }
n647=    halt 
n648=  }
n649=  if (%CflPrWAR == botfl) {
n650=    if ($dialog(botatak) != botatak) { dialog -mn botatak botatak }
n651=    if ($nick !isin %CflNick) { 
n652=      did -i botatak 13 1 $nick
n653=      write $shortfn($mrcdir) $+ texts\flbots.txt $nick
n654=      set %CflNick %CflNick $+ , $+ $nick 
n655=    }
n656=    halt
n657=  }
n658=  if (%CflPrWAR == singl) { 
n659=    if ($nick !isin %CflNick) { 
n660=      set -u $+ [ $calc(%ctcpfloodignor * 60) ] %CflPrWAR botfl 
n661=      set %CflNick %CflNick $+ , $+ $nick | dialog -mn botatak botatak 
n662=      halt
n663=    }
n664=    if ($dialog(singlfl) == singlfl) { 
n665=      %CflCont = %CflCont + 1
n666=      .timerstat1 -m 0 400 did -i singlfl 26 1 CTCP-Flood продолжается ( $+ Запросов: %CflCont $+ ) | .timerstat2 -m 0 800 did -r singlfl 26 
n667=    }
n668=    halt
n669=  }
n670=  if (%CflPrCHECK > 0) {
n671=    %CflPrCHECK = %CflPrCHECK + 1 
n672=    if (%CflNick != $nick) { 
n673=      set %CflPrWAR botfl
n674=      write $shortfn($mrcdir) $+ texts\flbots.txt %CflNick 
n675=      write $shortfn($mrcdir) $+ texts\flbots.txt $nick
n676=      dialog -mn botatak botatak | did -i botatak 13 1 %CflNick | did -i botatak 13 1 $nick
n677=      set %CflNick %CflNick $+ , $+ $nick
n678=      unset %CflPrCHECK
n679=      halt
n680=    }
n681=    if (%CflPrCHECK >= %ctcpfloodtimes) {
n682=      if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n683=      if (%CflPrMode == auto) { 
n684=        if (%CflPrDialog == show) { dialog -mn CflPrSwitch CflPrSwitch | did -i CflPrSwitch 12 1 Nick: $nick | .timerCPrOFF 1 $calc(%ctcpfloodignor * 60) .CPrOFF }
n685=        if (%CflPrKick == on) { CflKBalies $nick }
n686=        if (%CflPrWarn == on) { notice $nick 4! $+ %CflNick $+ 4-> %CflPrWarnMsg | set %notenick }
n687=        if (%CflPrMeth == igno) { .ignore -tu $+ $calc(%ctcpfloodignor * 60) *!*@* } 
n688=        if (%CflPrMeth == stop) { 
n689=          set %CflMethStop ON | .timerCflMEthSt 1 $calc(%ctcpfloodignor * 60) .unset %CflMethStop 
n690=        }
n691=        set %notenick $nick
n692=        halt
n693=      }
n694=      set %CflPrWAR singl | set %CflCont 0
n695=      if ($dialog(singlfl) != singlfl) { 
n696=        dialog -mn singlfl singlfl | dialog -t singlfl CTCP Flood from $nick 
n697=        did -i singlfl 16 1 Игнорировать CTCP-запросы от $nick в течении:
n698=      }
n699=      unset %CflPrCHECK    
n700=    }
n701=  }
n702=  if (%CflPrCHECK == $null) {
n703=    set %CflPrCHECK 1 | .timerCflCHECK 1 %ctcpfloodperiod unset %CflPrCHECK
n704=    set %CflNick $nick 
n705=    set %CflChan $comchan($nick,1) 
n706=  }
n707=  if ($isalias(skn.ctcp.ask) == $true && $isalias(skn.ctcp.rep) == $true) {
n708=    if ($1 == version) {
n709=      echo -a $skn.ctcp.ask($1)
n710=      if (%versrepmode == choo) { ctcpreply $nick VERSION %versrep | echo -a $skn.ctcp.rep($1,%versrep) }
n711=      if (%versrepmode == rand) { 
n712=        var %varCtcpRep = $read $mircdirtexts\versions.txt | ctcpreply $nick VERSION %varCtcpRep | echo -a $skn.ctcp.rep($1,%varCtcpRep) 
n713=      }
n714=      if (%soundthem == on) { if ($isalias(skn.snd.ctcp.V) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.ctcp.V } }
n715=
n716=    }
n717=    elseif ($1 == ping) {
n718=      echo -a $skn.ctcp.ask($1)
n719=      if (%pingrepmode == choo) { ctcpreply $nick PING %pingrep | echo -a $skn.ctcp.rep($1,%pingrep) }
n720=      if (%pingrepmode == rand) { 
n721=        var %varCtcpRep = $read $mircdirtexts\pings.txt | ctcpreply $nick PING %varCtcpRep | echo -a $skn.ctcp.rep($1,%varCtcpRep)
n722=      }
n723=      if (%pingrepmode == real) { ctcpreply $nick PING $2 | echo -a $skn.ctcp.rep($1,$2) }
n724=      if (%soundthem == on) { if ($isalias(skn.snd.ctcp.P) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.ctcp.P } }
n725=    }
n726=    elseif ($1 == time) {
n727=      echo -a $skn.ctcp.ask($1)
n728=      if (%timerepmode == choo) { ctcpreply $nick TIME %timerep | echo -a $skn.ctcp.rep($1,%timerep) }
n729=      if (%timerepmode == rand) { 
n730=        var %varCtcpRep = $read $mircdirtexts\times.txt | ctcpreply $nick TIME %varCtcpRep | echo -a $skn.ctcp.rep($1,%varCtcpRep)
n731=      }
n732=      if (%timerepmode == real) { 
n733=        var %varCtcpRep = $asctime(ddd - dd/mm/yyyy HH:nn:ss) GMT $+ $asctime(zz)
n734=        echo -a $skn.ctcp.rep($1,%varCtcpRep)
n735=        ctcpreply $nick TIME %varCtcpRep
n736=      }
n737=      if (%soundthem == on) { if ($isalias(skn.snd.ctcp.T) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.ctcp.T } }
n738=    }
n739=    elseif ($1 == $read -w $+ $1 $mircdirtexts\OtherCTCP.txt) { 
n740=      echo -a $skn.ctcp.ask($1)
n741=      if (%otherrepmode == on) { 
n742=        ctcpreply $nick $1 [ % $+ [ otherCTCPrep $+ [ $1 ] ] ] 
n743=        echo -a $skn.ctcp.rep($1, [ % $+ [ otherCTCPrep $+ [ $1 ] ] ] )
n744=      }
n745=    }
n746=    elseif ($1 == DCC) { goto dcc }
n747=    halt
n748=    :dcc
n749=  }
n750=  else {
n751=    if ($1 == version) {
n752=      if (%versrepmode == choo) { ctcpreply $nick VERSION %versrep }
n753=      if (%versrepmode == rand) { ctcpreply $nick VERSION $read $mircdirtexts\versions.txt }
n754=    }
n755=    elseif ($1 == ping) {
n756=      if (%pingrepmode == choo) { ctcpreply $nick PING %pingrep }
n757=      if (%pingrepmode == rand) { ctcpreply $nick PING $read $mircdirtexts\pings.txt }
n758=      if (%pingrepmode == real) { ctcpreply $nick PING $2 }
n759=    }
n760=    elseif ($1 == time) {
n761=      if (%timerepmode == choo) { ctcpreply $nick TIME %timerep }
n762=      if (%timerepmode == rand) { ctcpreply $nick TIME $read $mircdirtexts\times.txt }
n763=      if (%timerepmode == real) { ctcpreply $nick TIME $asctime(ddd - dd/mm/yyyy HH:nn:ss) GMT $+ $asctime(zz) }
n764=    }
n765=    elseif ($1 == $read -w $+ $1 $mircdirtexts\OtherCTCP.txt) { 
n766=      if (%otherrepmode == on) { ctcpreply $nick $1 [ % $+ [ otherCTCPrep $+ [ $1 ] ] ] }
n767=    }
n768=  }
n769=}
n770=;;;;;;;;;;;;;;;;;;;;
n771=; Private info msg
n772=; Add menu item to popup menu
n773=menu status,channel,query {
n774=  $iif($group(#autoresponse) == on,✓,-) Auto-Response
n775=  .enable/disable:{
n776=    if ($group(#autoresponse) == on) { .disable #autoresponse | echo -a Auto-Response Disabled }
n777=    else { .enable #autoresponse | echo -a Auto-Response Enabled }
n778=  }
n779=}
n780=
n781=; Main response script
n782=#autoresponse on
n783=on *:TEXT:*:?:{
n784=  if ($nick != $me) {
n785=    ; Check if we already responded to this nick using a hash table
n786=    if (!$hget(responded,$nick)) {
n787=      ; Create hash table if it doesn't exist
n788=      if (!$hget(responded)) { hadd -m responded timeout 3600 }
n789=
n790=      ; Mark this nick as responded to
n791=      hadd -m responded $nick 1
n792=
n793=      ; Send responses immediately without timers
n794=      msg $nick 4WARNING: I am an IRC Operator with full network access privileges. Think before you act.
n795=      msg $nick 2,15Please be mindful of your messages - they are being logged and monitored.
n796=      msg $nick 3System Uptime:12 $duration($system(uptime))
n797=      msg $nick 7OS Info:13 $os - CPU: $cpu - Memory: $memory(physical).free MB free
n798=      msg $nick 6,1Running mIRC version: $version - Screen Resolution: $screen - Active Window: $active
n799=    }
n800=  }
n801=}
n802=#autoresponse end
n803=
n804=; Clear the responded hash table when a query window is closed
n805=on *:CLOSE:?:{
n806=  hdel responded $nick
n807=}
n808=
n809=; Create the hash table on script load
n810=on *:LOAD:{
n811=  if (!$hget(responded)) { hadd -m responded timeout 3600 }
n812=}
n813=
n814=; Clean up hash table on script unload
n815=on *:UNLOAD:{
n816=  if ($hget(responded)) { hfree responded }
n817=}
n818=;end
n819=;;;;;;;;;;;;;;;;;;;;
n820=; File paths antispam
n821=alias -l getChannelFile { return $shortfn($mircdir) $+ texts\antispam_chan.txt }
n822=alias -l getServerFile { return $shortfn($mircdir) $+ texts\antispam_server.txt }
n823=
n824=; File handling functions
n825=alias -l loadChannels {
n826=  if ($isfile($getChannelFile)) {
n827=    var %x = 1
n828=    while (%x <= $lines($getChannelFile)) {
n829=      var %chan = $read($getChannelFile, %x)
n830=      if (%chan) { hadd -m antispam_channels %chan 1 }
n831=      inc %x
n832=    }
n833=  }
n834=}
n835=
n836=alias -l loadServers {
n837=  if ($isfile($getServerFile)) {
n838=    var %x = 1
n839=    while (%x <= $lines($getServerFile)) {
n840=      var %server = $read($getServerFile, %x)
n841=      if (%server) { hadd -m antispam_servers %server 1 }
n842=      inc %x
n843=    }
n844=  }
n845=}
n846=
n847=alias -l saveChannel {
n848=  var %chan = $1
n849=  if (%chan) {
n850=    write $getChannelFile %chan
n851=  }
n852=}
n853=
n854=alias -l saveServer {
n855=  var %server = $1
n856=  if (%server) {
n857=    write $getServerFile %server
n858=  }
n859=}
n860=
n861=alias -l deleteChannel {
n862=  var %chan = $1
n863=  if (%chan) {
n864=    write -dw" $+ %chan $+ " $getChannelFile
n865=  }
n866=}
n867=
n868=alias -l deleteServer {
n869=  var %server = $1
n870=  if (%server) {
n871=    write -dw" $+ %server $+ " $getServerFile
n872=  }
n873=}
n874=
n875=; GUI Menu creation
n876=menu channel {
n877=  $iif($group(#antispam).status == on, ✓) Antispam
n878=  .Settings: {
n879=    dialog -m antispam_settings antispam_settings
n880=  }
n881=  .Enable: { 
n882=    .enable #antispam
n883=    echo -a [Antispam] Script enabled
n884=  }
n885=  .Disable: {
n886=    .disable #antispam 
n887=    echo -a [Antispam] Script disabled
n888=  }
n889=}
n890=
n891=; Settings dialog
n892=dialog antispam_settings {
n893=  title "Antispam Settings"
n894=  size -1 -1 300 450
n895=
n896=  text "Protected channels:", 1, 5 5 290 20
n897=  list 2, 5 25 290 150, vsbar
n898=
n899=  button "Add", 3, 5 180 145 25
n900=  button "Delete", 4, 150 180 145 25
n901=
n902=  text "Allowed servers:", 5, 5 210 290 20
n903=  list 6, 5 230 290 150, vsbar
n904=
n905=  button "Add server", 7, 5 385 145 25
n906=  button "Delete server", 8, 150 385 145 25
n907=
n908=  check "Enable Antispam", 9, 5 420 290 25
n909=}
n910=
n911=; Dialog events
n912=on *:DIALOG:antispam_settings:init:*:{
n913=  if ($group(#antispam).status == on) { did -c $dname 9 }
n914=
n915=  ; Load channels
n916=  if ($isfile($getChannelFile)) {
n917=    var %x = 1
n918=    while (%x <= $lines($getChannelFile)) {
n919=      var %chan = $read($getChannelFile, %x)
n920=      if (%chan) { did -a $dname 2 %chan }
n921=      inc %x
n922=    }
n923=  }
n924=
n925=  ; Load servers
n926=  if ($isfile($getServerFile)) {
n927=    var %x = 1
n928=    while (%x <= $lines($getServerFile)) {
n929=      var %server = $read($getServerFile, %x)
n930=      if (%server) { did -a $dname 6 %server }
n931=      inc %x
n932=    }
n933=  }
n934=}
n935=
n936=on *:DIALOG:antispam_settings:sclick:3:{
n937=  var %chan = $?="Enter channel name (#channel):"
n938=  if ($left(%chan, 1) !== #) { %chan = # $+ %chan }
n939=  if (%chan) {
n940=    did -a $dname 2 %chan
n941=    hadd -m antispam_channels %chan 1
n942=    saveChannel %chan
n943=  }
n944=}
n945=
n946=on *:DIALOG:antispam_settings:sclick:4:{
n947=  if ($did(2).sel) {
n948=    var %chan = $did(2).seltext
n949=    hdel antispam_channels %chan
n950=    deleteChannel %chan
n951=    did -d $dname 2 $did(2).sel
n952=  }
n953=}
n954=
n955=on *:DIALOG:antispam_settings:sclick:7:{
n956=  var %server = $?="Enter server address:"
n957=  if (%server) {
n958=    did -a $dname 6 %server
n959=    hadd -m antispam_servers %server 1
n960=    saveServer %server
n961=  }
n962=}
n963=
n964=on *:DIALOG:antispam_settings:sclick:8:{
n965=  if ($did(6).sel) {
n966=    var %server = $did(6).seltext
n967=    hdel antispam_servers %server
n968=    deleteServer %server
n969=    did -d $dname 6 $did(6).sel
n970=  }
n971=}
n972=
n973=on *:DIALOG:antispam_settings:sclick:9:{
n974=  if ($did(9).state) { .enable #antispam }
n975=  else { .disable #antispam }
n976=}
n977=
n978=; Main antispam functionality
n979=#antispam on
n980=on *:TEXT:*:#:{
n981=  ; Check if channel is protected
n982=  if (!$hget(antispam_channels, $chan)) { return }
n983=
n984=  ; Check if server is allowed
n985=  if (!$hget(antispam_servers, $server)) { return }
n986=
n987=  ; Spam detection flag
n988=  var %isSpam = $false
n989=  var %text = $1-
n990=
n991=  ; Basic spam patterns
n992=  if ($regex(%text, /([.*'*._\/:|\\-]{5,})|(\s{5,})|(\birc\.\w+\.\w+\b)|(#\w{5,})|(\.*''\.*)|(\.''\.)/i)) { 
n993=    %isSpam = $true 
n994=  }
n995=
n996=  ; Repeated characters
n997=  if ($regex(%text, /(.)\1{4,}/i)) { 
n998=    %isSpam = $true 
n999=  }
n1000=
n1001=  ; URL spam
n1002=  if ($regex(%text, /(https?:\/\/|www\.)[^\s]{10,}/i)) { 
n1003=    %isSpam = $true 
n1004=  }
n1005=
n1006=  ; Mass mentions
n1007=  if ($regex(%text, /(@\w+\s*){3,}/)) { 
n1008=    %isSpam = $true 
n1009=  }
n1010=
n1011=  ; CAPS
n1012=  if ($regex(%text, /[A-Z\s]{20,}/)) { 
n1013=    %isSpam = $true 
n1014=  }
n1015=
n1016=  ; Numeric spam
n1017=  if ($regex(%text, /\d{15,}/)) { 
n1018=    %isSpam = $true 
n1019=  }
n1020=
n1021=  ; Smileys
n1022=  if ($regex(%text, /(:|;)-?[\(\)\/\[\]]{1,}/)) { 
n1023=    %isSpam = $true 
n1024=  }
n1025=
n1026=  ; Keywords
n1027=  if ($regex(%text, /\b(free\s*(coins?|points?)|verify|winner|prize)\b/i)) { 
n1028=    %isSpam = $true 
n1029=  }
n1030=
n1031=  ; If spam detected
n1032=  if (%isSpam) {
n1033=    if ($nick !isop $chan) {
n1034=      var %host = $gettok($address($nick, 5), 2, 64)
n1035=      mode $chan +b *!*@ $+ %host
n1036=      kick $chan $nick Spam is prohibited! Automatic ban.
n1037=      echo -a [Antispam] User $nick ( $+ $address($nick, 5) $+ ) banned on channel $chan
n1038=    }
n1039=    else {
n1040=      msg $chan Failed to kick $nick - user is protected!
n1041=    }
n1042=    haltdef
n1043=  }
n1044=}
n1045=#antispam end
n1046=
n1047=; Initialize on script load
n1048=on *:LOAD:{
n1049=  ; Create hashtables
n1050=  hmake antispam_channels 10
n1051=  hmake antispam_servers 10
n1052=
n1053=  ; Create directories if they don't exist
n1054=  mkdir " $+ $shortfn($mircdir) $+ texts"
n1055=
n1056=  ; Load saved data
n1057=  loadChannels
n1058=  loadServers
n1059=}
n1060=
n1061=; Cleanup on unload
n1062=on *:UNLOAD:{
n1063=  hfree antispam_channels
n1064=  hfree antispam_servers
n1065=}
n1066=
n1067=;;;;;;;;;;;;;;;;;;;;
n1068=on ^*:TEXT:*:#:{
n1069=  if (%TflProtect == on) {
n1070=    if (%TflPrWar == ON) { 
n1071=      if ($nick == %TflPrNick) { 
n1072=        if (%TflPrWarnB == on) { ban -u $+ $calc(%TflPrSinglB * 60) %TflPrChan %TflPrNick 3 }
n1073=        if (%TflPrWarnK == on) { kick %TflPrChan %TflPrNick %FlKreasText }
n1074=        unset %TflPrWar
n1075=        halt
n1076=      } 
n1077=    }
n1078=    if (%TflPr. [ $+ [ $nick ] ] > 0) {
n1079=      inc %TflPr. [ $+ [ $nick ] ] 1
n1080=      if (%TflPr. [ $+ [ $nick ] ] >= %TflPrTimes) {
n1081=        if (%soundthem == on) { if ($isalias(skn.snd.flood) == $true) { splay $mircdirskins $+ \ $+ $skn.snd.flood } }
n1082=        if (%TflPrMode == auto) { 
n1083=          set %TflPrNick $nick | set %TflPrChan $chan
n1084=          if (%TflPrDialog == show) { if ($dialog(TflPrSwitch) != TflPrSwitch) dialog -mn TflPrSwitch TflPrSwitch }
n1085=          if (%TflPrWarn == on) { 
n1086=            if (%SelfFlPr != on) { msg %TflPrChan 4! $+ %TflPrNick $+ 4-> %TflPrWarnMsg | set -u5 %SelfFlPr on }
n1087=            set -u [ $+ [ $calc(%TflPrIgnore * 60) ] ] %TflPrWar ON 
n1088=          }
n1089=          if (%TflPrWarn == off) { 
n1090=            if (%TflPrBan == on) { ban -u $+ $calc(%TflPrSinglB * 60) %TflPrChan %TflPrNick 3 } 
n1091=            kick %TflPrChan %TflPrNick %FlKreasText
n1092=          }
n1093=        }
n1094=        if (%TflPrMode == manu) { 
n1095=          if ($dialog(TflDetect) != TflDetect) { 
n1096=            dialog -mn TflDetect TflDetect | dialog -t TflDetect TEXT Flood от $nick на канале $chan
n1097=            did -i TflDetect 16 1 Игнорировать $nick в течении: | set %TflPrNick $nick | set %TflPrChan $chan
n1098=          } 
n1099=          if ($dialog(TflDetect) == TflDetect) { }
n1100=        }
n1101=        unset %TflPr. [ $+ [ $nick ] ]
n1102=      }
n1103=    }
n1104=    else { set -u [ $+ [ %TflPrPeriod ] ] %TflPr. [ $+ [ $nick ] ] 1 }
n1105=  }
n1106=  if (%SwearMode == on) && ($me isop $chan) { 
n1107=    var %SCInd = 0
n1108=    :nextW
n1109=    inc %SCInd 1
n1110=    if (%SCInd > $lines($mircdirtexts\Swear.txt)) { goto more }
n1111=    var %SKchWord = $read -l $+ %SCInd $mircdirtexts\Swear.txt
n1112=    var %SKchWordIN = $replace(%SKchWord,а,А,б,Б,в,В,г,Г,д,Д,е,Е,ё,Ё,ж,Ж,з,З,и,И,й,Й,к,К,л,Л,м,М,н,Н,о,О,п,П,р,Р,с,С,т,Т,у,У,ф,Ф,х,Х,ц,Ц,ч,Ч,ш,Ш,щ,Щ,ъ,Ъ,ы,Ы,ь,Ь,э,Э,ю,Ю,я,Я)
n1113=    var %SKchWordOUT = $replace($1-,а,А,б,Б,в,В,г,Г,д,Д,е,Е,ё,Ё,ж,Ж,з,З,и,И,й,Й,к,К,л,Л,м,М,н,Н,о,О,п,П,р,Р,с,С,т,Т,у,У,ф,Ф,х,Х,ц,Ц,ч,Ч,ш,Ш,щ,Щ,ъ,Ъ,ы,Ы,ь,Ь,э,Э,ю,Ю,я,Я)
n1114=    if (%SKchWordIN isin %SKchWordOUT) { SwearAction $chan $nick | goto more }
n1115=    goto nextW
n1116=  }
n1117=  :more
n1118=  if (%colmsg == on) && ($nick == $snick(#,1)) { 
n1119=    if (%colmsgtype == 1) { echo $colour(highlight) $chan $timestamp < $+ $nick $+ > $1- | halt }
n1120=    if (%colmsgtype == 3) { echo $colour(normal) $chan $timestamp < $+ $nick $+ > $1- | beep 2 950 | halt }
n1121=  }
n1122=}
n1123=on 1:close:@:{
n1124=  if ($target == @NeoTerminal) { dialog -m NeoTerminal NeoTerminal | sockclose TermSockName | set %TermFullScr no }
n1125=  if ($target == @NEORA_NEWS && %UPDre != off) { dialog -m UPDremind UPDremind }
n1126=  if ($target == @NeoRa_LagMonitoring_1.0) {
n1127=    .timerLag1 off
n1128=    .disable #NRgL_pong
n1129=  }
n1130=}
n1131=;###################################################
